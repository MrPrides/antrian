<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detail Pasien</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    
    {% for message in messages %}
        
    <div class="alert alert-{{message.tags}} alert-dismissible fade show mt-4" role="alert">
        <strong>{{message}}</strong> 
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

{% endfor %}

    
    <form action=" {% url 'pasien_detail' pasien.pk %} " method="post">
        {% csrf_token %}
        <!-- <input type="hidden" name="pasien_id" value="{{ pasien_id }}"> -->
        <h3>Detail Pasien</h1>
            <p><strong>No MR:</strong> {{pasien.no_mr}}</p>
            <p><strong>Nama:</strong> {{pasien.nama}}</p>
            <p><strong>Tanggal Lahir:</strong> {{pasien.tgl_lahir}}</p>
            <p><strong>Alamat:</strong> {{pasien.alamat}}</p>

        <div class="form-group">
            <h2>Pilih Dokter</h2>
            <label for="dokter">Dokter:</label>
            <select name="dokter" class="form-select" id="dokter-select" class="form-control">
                {% for dokter in dokter_list  %}
                <option value="{{dokter.id}}" data-jadwal="{{ dokter.jadwal_praktek }}">{{dokter.nama_dokter}} ({{dokter.dokter_spesialis}})</option>
                {% endfor %} 
            </select>
        </div>
        <div class="form-group mt-2">
            <label for="jadwal">Jadwal Dokter:</label>
            <select name="jadwal" class="form-select" id="jadwal-select" class="form-control">
                <option value="">Pilih Jadwal</option>
            </select>
        </div>
        <div class="form-group mt-2" >
            <label for="tanggal">Tanggal Pendaftaran:</label>
            <input type="date" name="tanggal_berobat" id="tanggal" class="form-control">
        </div>
        <div class="mt-3">
            <button type="submit" action=" {% url 'pendaftaran_list' %} " class="btn btn-primary">Daftar</button>
        </div>
        


    </form>

    <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            function updateSchedule() {
                var dokterSelect = document.getElementById('dokter-select');
                var jadwalSelect = document.getElementById('jadwal-select');
                var selectedDokter = dokterSelect.options[dokterSelect.selectedIndex];
                jadwalSelect.innerHTML = '<option value="">Pilih Jadwal</option>';
                
                if (selectedDokter) {
                    var jadwal = selectedDokter.getAttribute('data-jadwal');
                    if (jadwal) {
                        jadwal.split(',').forEach(function(schedule) {
                            var option = document.createElement('option');
                            option.value = schedule.trim();
                            option.text = schedule.trim();
                            jadwalSelect.appendChild(option);
                        });
                    }
                }
            }

            document.getElementById('dokter-select').addEventListener('change', updateSchedule);
            updateSchedule();
        });

        document.addEventListener('DOMContentLoaded', function () {
            var today = new Date().toISOString().split('T')[0];
            document.getElementById('tanggal').setAttribute('min', today);
        });

        
    </script>
</body>
</html>